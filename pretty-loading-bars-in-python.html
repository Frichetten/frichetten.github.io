<!DOCTYPE html>
<html>
<!--
   ##########################################
   #░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░#
   #░░░░░░░▄▄▀▀▀▀▀▀▀▀▀▀▄▄█▄░░░░▄░░░░█░░░░░░░#
   #░░░░░░█▀░░░░░░░░░░░░░▀▀█▄░░░▀░░░░░░░░░▄░#
   #░░░░▄▀░░░░░░░░░░░░░░░░░▀██░░░▄▀▀▀▄▄░░▀░░#   Checking out my code? I like you.
   #░░▄█▀▄█▀▀▀▀▄░░░░░░▄▀▀█▄░▀█▄░░█▄░░░▀█░░░░#
   #░▄█░▄▀░░▄▄▄░█░░░▄▀▄█▄░▀█░░█▄░░▀█░░░░█░░░#   Looking to hire me? You can reach
   #▄█░░█░░░▀▀▀░█░░▄█░▀▀▀░░█░░░█▄░░█░░░░█░░░#   me with my contact info. Tell me
   #██░░░▀▄░░░▄█▀░░░▀▄▄▄▄▄█▀░░░▀█░░█▄░░░█░░░#   you found this and I will be much
   #██░░░░░▀▀▀░░░░░░░░░░░░░░░░░░█░▄█░░░░█░░░#   more interested in working for your
   #██░░░░░░░░░░░░░░░░░░░░░█░░░░██▀░░░░█▄░░░#   company!
   #██░░░░░░░░░░░░░░░░░░░░░█░░░░█░░░░░░░▀▀█▄#
   #██░░░░░░░░░░░░░░░░░░░░█░░░░░█░░░░░░░▄▄██#
   #░██░░░░░░░░░░░░░░░░░░▄▀░░░░░█░░░░░░░▀▀█▄#
   #░▀█░░░░░░█░░░░░░░░░▄█▀░░░░░░█░░░░░░░▄▄██#
   #░▄██▄░░░░░▀▀▀▄▄▄▄▀▀░░░░░░░░░█░░░░░░░▀▀█▄#
   #░░▀▀▀▀░░░░░░░░░░░░░░░░░░░░░░█▄▄▄▄▄▄▄▄▄██#
   #░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░#
   ##########################################
-->
	  
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="description" content="Develop custom loading bars in command line using Python 3.X and 2.7.">
    <title>Pretty Loading Bars in Python</title>

    <!-- CSS and Fonts -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
	<link href="vendor/font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href="css/site-style.css" rel="stylesheet">
    <link href='https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>
</head>

<body style="width:100%;height:100%;margin: 0px;padding:0px;overflow-x:hidden;">
    <!-- Navigation -->
    <nav class="navbar navbar-default navbar-custom navbar-fixed-top">
        <div class="container-fluid">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header page-scroll">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                    <span class="sr-only">Toggle navigation</span>
                    Menu <i class="fa fa-bars"></i>
                </button>
                <a class="navbar-brand" href="/">Nicholas Frichette</a>
            </div>

            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                <ul class="nav navbar-nav navbar-right">
                    <li>
                        <a href="/">Home</a>
                    </li>
		    <li>
                        <a href="bloghome">Blog</a>
                    </li>
                    <li>
                        <a href="about">About Me</a>
                    </li>
                    <li>
                        <a href="Resume.pdf">Resume</a>
                    </li>
                    <li>
                        <a href="https://github.com/Frichetten">Github</a>
                    </li>
		    <li>
                        <a href="projects">Projects</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Page Header -->
    <header class="intro-header" style="background-image: url('img/loading.jpg')">
        <div class="container">
            <div class="row">
                <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                    <div class="site-heading">
                        <h1>Pretty Loading Bars in Python</h1>
                        <hr class="small">
                        <span class="subheading"></span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <div class="container" style="margin-top:-50px">
        <div class="row">
		<div class="center-block" style="margin-left: 15px;margin-right: 15px;">	
			<p style="text-align:center;"><img src="img/loadbar.gif" style="max-width:100%"></p>
			<p>
			<b>NOTE:</b> This article and its explanations are primarily focused on Python 3.X, however the conversion to Python 
			2.7 is very simple. Be aware of your integer division, and print functions and it will be a cake 
			walk. I have attached the Python 2.7 implementation at the bottom of this page for convenience. 
			<b>If you find a bug, mistake, or edge case, please let me know! I'd like to correct it.</b><br><br>
			Loading bars (also known as progress bars) are a succinct and efficient means of communicating 
			to the user how much longer your program will run. They have very specific uses (<a href="
			https://en.wikipedia.org/wiki/Halting_problem">Halting Problem</a> 
			anyone?), and they look really cool in the command line.<br><br>
			There's a problem though, they're not the most intuitive thing to make. To a beginner or even an 
			intermediate programmer, it may be a tricky thing to wrap your head around. Never fear! I will 
			show you exactly how to pull this off in Python.<br><br>
			You should know in advance that there are plenty of libraries that are more than willing to do 
			the heavy lifting for you. That being said, creating your own is more fun, and will leave you 
			feeling more accomplished. This particular implementation works without importing any additional 
			non-standard libraries, and works on both Linux (Arch and Ubuntu) as well as Windows.<br>
			<h3>Starting Off</h3>
			Quickly, lets get an idea of how we would go about this. Lets see what a typical for loop looks 
			like in Python.<br><br>
			<pre>for item in list:<br>   print(item)</pre><br>
			For the unfamiliar, we are saying "for each element (item) in this list (list), perform some task" 
			and that task is printing the value of the item. Simple enough, but how would we turn this into the 
			same output in the gif at the top of this article?<br><br>
			To some extent, we are accomplishing part of our goal. We are printing something after each operation 
			in the loop. Only problem is that we will write to a new line each time, and it would not be very 
			elegant to put the loading bar code in the loop itself.<br><br>
			The answer to our problem lies in the "list" object itself. Under the hood, Python queries that "list" 
			object looking for something called an <a href="https://en.wikipedia.org/wiki/Iterator">Iterator Object</a>. 
			Using that Iterator object, the language will repeatedly call the __next__() function until a 
			StopIteration exception is raised (in Python 2.7 this function is instead called "next()").<br><br>
			The beauty of this is that we can <a href=" https://en.wikipedia.org/wiki/Method_overriding">override the function</a>  
			and write our own code for it. An example of this can be seen below.<br><br>
			<pre>class loadingBar:<br>    def __init__(self, total):<br>        self.index = 0
        self.total = total<br><br>    def __iter__(self):<br>        return self<br><br>    def __next__(self):
        if self.index < self.total:<br>            self.index += 1<br>        else:<br>            raise StopIteration()</pre><br>
			Here's where the implementation gets cute, that __next__ function will get called for every iteration in 
			the loop. This is where we would want to print the loading bar to the screen. Go ahead and modify my code 
			to do this now. On your own. Go do it, see what happens. Are you done? You back? Great, what happened? Yeah, 
			it just printed stuff out on different lines. That's not what we want, how do we fix it? Something called 
			"Carriage Return" (yes it's named after the Carriage Return function of a typewriter). Carriage Return, or 
			as we will come to know it "\r", will reset the buffer on the console and return to index 0 of the line. 
			This will allow us to overwrite what we have previously written on the same line. The following code will 
			show our new __next__ function.<br>
			<h3>Prototype</h3>
			<pre>def __next__(self):<br>    if self.index < self.total:<br>        self.index += 1
        index = self.index<br><br>        length = 26<br>        negSpace = int(index /(self.total/length))
        space = length-negSpace<br>        percent = int(index/self.total*100)<br><br>        print('\r', end='')
        print('<{0}{1}> {2}%'.format('-'*negSpace,<br>            ' '*(space),<br>            percent), end='')<br><br>        sleep(0.1)
        return index<br>    else:<br>        raise StopIteration()</pre><br>
			Now, lets go over what this code will do. The first part is simple enough, we are just incrememting our 
			index in the iterator. The variable "length" is the actual length of the bar in the command line. It can 
			be as long as you want with 1 caveat. This loading bar cannot be more wide than the screen it is on. This 
			makes sense (where is it going to go?), and if you do make it wider, it will simply over lap into the next 
			line. Personally, I am fond of widths from between 20 and 50.<br><br>
			That "negSpace" variable is a little bit more complicated. We want to make sure that no matter what, regardless 
			of how many elements are in the list, we want the bar to stay that same width. This is accomplished with a 
			small formula I cooked up (using basic Algebra. Really making use of that Comp Sci degree :P ). We first 
			take the length of the list (self.total) and divide that by our chosen bar width. This will give us a fraction 
			which we will then use to divide the index (the iteration in the loop). This will give us the correct number 
			of "-" to fill the space. This will be the progress in the bar. (For the Python 2.7 version be careful with 
			integer division here. It may be beneficial to print out the result of this equation and debug it yourself.)<br><br>
			After that, we need to determine how much space will be in the bar still, we do this by subtracting the length 
			with that negSpace variable. Finally we calculate the percentage of completion by index/self.total * 100.<br><br>
			Now this is the part where we use the carriage return. We simply print "\r" and be sure to use the "end=''" 
			flag as this will ensure that we stay on the same line (in Python 2.7, simply place a comma at the end of the 
			print statement so that it stays on the same line). In the next print statement we use some string 
			formatting magic (What is basically printf from C). Here we have some loading bar boundaries (the "<>" part) 
			followed by the number of progress chunks and spaces. We finish it up by showing the percent until complete.<br><br>
			Be aware that the next part is optional depending on what type of machine you are running the code on. 
			On some versions of Linux, the "sys.stdout.flush()" is completely optional (like on Arch Linux), 
			however if you try to go without it on Windows (at least on my machine), it will only print the last 
			line. Comment it out and see if it still works for you.<br><br>			
			The final part to talk about is the sleep function. That is completely optional and is only there to show that 
			the code is actually working. For a real implementation, you would want to remove it, and rely on how long it 
			takes to perform the operation in the original for loop.<br>
			<h3>Putting Everything Together</h3>
			Lets finish this out with how we will call this function. The nice part about this implementation is that we 
			don't have to alter our loop at all. We just need to create the loading bar object first, and pass in the length 
			of the list. After that, you can use that object in your for loop like you normally would. Below is the complete 
			code for the entire application.<br>
			<h3>Final Code (Python 3.X)</h3>
			<pre>import sys<br>from time import sleep<br><br>class loadingBar:<br>    def __init__(self, total):<br>        self.index = 0
        self.total = total<br><br>    def __iter__(self):<br>        return self<br><br>    def __next__(self):<br>        if self.index < self.total:<br>            self.index += 1
            index = self.index<br><br>            length = 26<br>            negSpace = int(index /(self.total/length))
            space = length-negSpace<br>            percent = int(index/self.total*100)<br><br>            print('\r', end='')
            print('<{0}{1}> {2}%'.format('-'*negSpace,<br>                ' '*(space),<br>                percent), end='')<br>            sys.stdout.flush()<br><br>            sleep(0.1)
            return index<br>        else:<br>            raise StopIteration()<br><br>a = [x for x in range(50)]<br>loadList = loadingBar(len(a))
for item in loadList:<br>    #Do some work here, remove 'None' when done<br>    None<br><br>print()</pre><br>
			<h3>Final Code (Python 2.7)</h3>
			<pre>import sys<br>from time import sleep<br><br>class loadingBar:<br>    def __init__(self, total):<br>        self.index = 0<br>        self.total = total<br><br>    def __iter__(self):<br>            return self<br><br>    def next(self):<br>        if self.index < self.total:<br>            self.index += 1<br>            index = self.index<br><br>            length = 25<br>            negSpace = int(index /(float(self.total)/length))<br>            space = length-negSpace<br>            percent = int((index/float(self.total))*100)<br><br>            print '\r',<br>            print '<{0}{1}> {2}%'.format('-'*negSpace, ' '*(space), percent) ,<br>            sys.stdout.flush()<br><br>            sleep(0.1)<br>            return index<br>        else:<br>            raise StopIteration()<br><br>a = [x for x in range(100)]<br>loadList = loadingBar(len(a))<br>for item in loadList:<br>    #Do some work here, remove 'None' when done<br>    None<br><br>print ''</pre>
			And thats all. This code should accept a list of any size and display a pretty loading bar for you. Be aware 
			it is not possible to print in the for loop while you have this active (How could you write on the 
			same line, while moving the stdout buffer?).<br><br>
			I encourage you to customize this as much as you like by changing the width of the bar and changing the symbols 
			of the bar itself, such as changing the '<' to '['. Below is my favorite version using the unicode character '\u2588'.
			</p>
			<p style="text-align:center"><img src="img/loadbar2.gif" style="max-width:100%"></p>
		</div>					
        </div>
    </div>

    <!-- Contact Info -->
    <footer>
        <div class="container">
            <div class="row">
                <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                    <ul class="list-inline text-center">
                        <li>
                            <a href="https://github.com/Frichetten">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li>
			<li>
                            <a href="https://www.linkedin.com/in/nick-frichette-633297126">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="fa fa-linkedin fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </footer>

	<!-- JavaScript -->
	<!-- jQuery -->
    <script src="vendor/jquery/jquery.min.js"></script>
	
    <!-- Bootstrap Core JavaScript -->
    <script src="vendor/bootstrap/js/bootstrap.min.js"></script>

    <!-- Contact Form JavaScript -->
    <script src="js/jqBootstrapValidation.js"></script>
    <script src="js/contact_me.js"></script>

    <!-- Theme JavaScript -->
    <script src="js/clean-blog.min.js"></script>
	
	<!-- Fun Stuff -->
	<script type="text/javascript" src="js/fun.js"></script>

</body>
</html>
